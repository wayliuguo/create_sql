SELECT
  fdate,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.PAGE_EXPOSE') THEN fuid END) AS `页面曝光`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.PAGE_EXPOSE') THEN fuid END) AS `PAGE_EXPOSE`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.ATTR_START') THEN fuid END) AS `ATTR_START`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.ATTR_SUCCESS') THEN fuid END) AS `ATTR_SUCCESS`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.QUERY_YQQZQ_INFO_REPAY_SPLIT_INFO_START') THEN fuid END) AS `QUERY_YQQZQ_INFO_REPAY_SPLIT_INFO_START`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.NEW_CAL_START') THEN fuid END) AS `NEW_CAL_START`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.NEW_CAL_SUCCESS') THEN fuid END) AS `NEW_CAL_SUCCESS`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.GET_DEFAULT_CARD_START') THEN fuid END) AS `GET_DEFAULT_CARD_START`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.PAGE_SUCCESS_EXPOSE') THEN fuid END) AS `PAGE_SUCCESS_EXPOSE`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '无可用渠道') THEN fuid END) AS `无可用渠道`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-查询初始信息retcode异常') THEN fuid END) AS `还款方案调整页-查询初始信息retcode异常`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-渠道值为空') THEN fuid END) AS `还款方案调整页-渠道值为空`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-非yqq流程') THEN fuid END) AS `还款方案调整页-非yqq流程`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-查询初始信息网络异常') THEN fuid END) AS `还款方案调整页-查询初始信息网络异常`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-调查询拆单信息接口retcode异常') THEN fuid END) AS `还款方案调整页-调查询拆单信息接口retcode异常`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '待还方案列表错误') THEN fuid END) AS `待还方案列表错误`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '待还信息错误') THEN fuid END) AS `待还信息错误`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款日信息错误') THEN fuid END) AS `还款日信息错误`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '待还订单错误') THEN fuid END) AS `待还订单错误`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-查询拆单信息接口网络异常') THEN fuid END) AS `还款方案调整页-查询拆单信息接口网络异常`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '分期数信息异常') THEN fuid END) AS `分期数信息异常`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-调用试算接口retcode异常') THEN fuid END) AS `还款方案调整页-调用试算接口retcode异常`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-调用试算接口试算信息异常') THEN fuid END) AS `还款方案调整页-调用试算接口试算信息异常`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-查询默认银行卡信息retcode异常') THEN fuid END) AS `还款方案调整页-查询默认银行卡信息retcode异常`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR' AND JSONExtractString(fextend_info, 'error_msg') = '还款方案调整页-查询默认银行卡信息网络异常') THEN fuid END) AS `还款方案调整页-查询默认银行卡信息网络异常`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.ORDER_CONFIRM_CLICK') THEN fuid END) AS `ORDER_CONFIRM_CLICK`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.SHOW_SELECT_FQ_NUM_TOAST') THEN fuid END) AS `SHOW_SELECT_FQ_NUM_TOAST`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.SHOW_ADD_BANKCARD_TOAST') THEN fuid END) AS `SHOW_ADD_BANKCARD_TOAST`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.PROCESS_BIND_START') THEN fuid END) AS `PROCESS_BIND_START`,
  COUNT(DISTINCT CASE WHEN (fevent_pos = 'CM_M.CASH.REPAY_OFFER.PROCESS_BIND_SUCCESS') THEN fuid END) AS `PROCESS_BIND_SUCCESS`
FROM dp_click.t_user_behavior_business_log
WHERE fdate BETWEEN '2023-01-01' AND '2023-01-31'
  AND fevent_pos in ('CM_M.CASH.REPAY_OFFER.PAGE_EXPOSE', 'CM_M.CASH.REPAY_OFFER.ATTR_START', 'CM_M.CASH.REPAY_OFFER.ATTR_SUCCESS', 'CM_M.CASH.REPAY_OFFER.QUERY_YQQZQ_INFO_REPAY_SPLIT_INFO_START', 'CM_M.CASH.REPAY_OFFER.NEW_CAL_START', 'CM_M.CASH.REPAY_OFFER.NEW_CAL_SUCCESS', 'CM_M.CASH.REPAY_OFFER.GET_DEFAULT_CARD_START', 'CM_M.CASH.REPAY_OFFER.PAGE_SUCCESS_EXPOSE', 'CM_M.CASH.REPAY_OFFER.MAIN_PROCESS_ERROR', 'CM_M.CASH.REPAY_OFFER.ORDER_CONFIRM_CLICK', 'CM_M.CASH.REPAY_OFFER.SHOW_SELECT_FQ_NUM_TOAST', 'CM_M.CASH.REPAY_OFFER.SHOW_ADD_BANKCARD_TOAST', 'CM_M.CASH.REPAY_OFFER.PROCESS_BIND_START', 'CM_M.CASH.REPAY_OFFER.PROCESS_BIND_SUCCESS')
  AND fpage_url LIKE '%https://cm.m.fenqile.com/entry/cash/repay_offer/index.html?cl=1500244%'
GROUP BY fdate